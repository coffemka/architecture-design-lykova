# Диаграмма контейнеров

![Контейнеры системы](../LabWork2/c4-container-new.png)

# Диаграммы компонентов

## Диаграмма компонентов - телеграм бот
![Компонент телеграм бота](../LabWork2/c4-components-telegram-new.png)

## Диаграмма компонентов - консультации

![Компонент консультаций](../LabWork2/c4-conponents-backend-new.png)

# Диаграмма последовательностей

![Диаграмма последовальности](./sequence-diagram.png)

Вариант использования — Запись студента на консультацию через Telegram-бота.

## Создание и публикация слота преподавателем

Преподаватель через свое Electron-приложение создает новый слот для консультации, указывая время и продолжительность. Backend сохраняет слот в PostgreSQL со статусом "свободен" и через сервис интеграции автоматически создает соответствующее событие в Яндекс.Календаре. Преподаватель получает публичную ссылку на это событие, которая автоматически публикуется телеграм боте.

## Запись студента через Telegram

Студент видит в чате сообщение с приглашением записаться. Взаимодействуя с Telegram-ботом, студент:

* Получает список доступных слотов, который бот запрашивает у Backend API.
* Выбирает удобное время из предложенного списка.
* Указывает тему предстоящей консультации в текстовом сообщении.

## Обработка записи системой

Backend API, получив от бота данные о выборе студента:

1) Через управление расписаний резервирует слот в БД, меняя его статус на "ожидание" и привязывая к карточке студента.
2) Обновляет событие в Яндекс.Календаре, добавляя в описание информацию о студенте и теме.
3) Мгновенно уведомляет преподавателя в его Electron-приложении через WebSocket о новой записи и планирует отправку напоминания в Telegram за час до консультации.
4) Подтверждает боту успешную запись, и бот сообщает студенту, что его запись принята и ожидает подтверждения.

## Подтверждение преподавателем: 

Преподаватель в своем интерфейсе видит новую запись в статусе "ожидание". После проверки он нажимает кнопку подтверждения. Backend:
1) Обновляет статус слота на "подтверждено" в БД.
2) Вносит финальные правки в событие Яндекс.Календаря (например, меняет цвет или добавляет метку).
3) Дает команду Telegram-боту отправить студенту персональное сообщение с подтверждением.
4) Обновляет интерфейс преподавателя и статистику по академической нагрузке.

# Диаграмма UML для базы данных PostgreSQL

![Диаграмма базы данных](./postgresql.png)

Teacher - содержит информацию о преподавателе, основном пользователе системы. Хранит уникальный идентификатор в Telegram для связи с ботом, а также идентификатор Яндекс.Календаря для автоматической синхронизации расписания.

Student - содержит информацию о студентах, косвенных пользователях системы. Включает Telegram ID для коммуникации через бота, академическую группу и контактные данные. Карточки студентов создаются автоматически при первой записи на консультацию.

ConsultationSlot - центральная сущность для управления временными слотами консультаций. Содержит временные параметры, статус слота для визуализации в интерфейсе преподавателя, а также технические поля для интеграции с Яндекс.Календарём.

Booking - управляет процессом бронирования слотов студентами. Фиксирует тему консультации, статус бронирования (ожидание/подтверждено/отменено/завершено).

ConsultationJournal - сущность для ведения академического журнала консультаций. Содержит фактические данные о проведенной консультации, обсуждаемые темы, использованные материалы, оценку прогресса студента и план дальнейших действий. Эта информация формирует статистику академической нагрузки и активность студентов.

